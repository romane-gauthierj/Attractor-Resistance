
April 28 
- Finished : identify lung drug and stratify patients according to LN_IC50
- Tried : download omnipath and understanding omnipath, run ROMA on lung cancer according to drug sensitivity 
- Todo : try to download omnipath, try having a margin when stratify patients, identify differently expressed proteins in lung with ROMA + identify differently expressed pathways in lung, try to change the transition rate to random in the general cfg file, find papers about how to create cfg files based on data expression/ abundance and papers about explore drug sensitivity, clean organization 


April 29

- Finished : downloaded omnipath on R, reorganized folders
- Tried: filter out some of the samples and try running ROMA on smaller dataset on 10 patient samples but no pathway/ gene significantly differently expressed bw sensitive and resistant.
- Todo:
ROMA : genes contribute most to overdispersion are selected like in the paper (L1 in the rRoma.output$ModuleMatrix)-> maybe shifted is better ?pathways only overdispersed not shifted

proteomics data cell model passport:  mass spectrometry data provides relative intensity -> can compare accross samples.


TO DO - try repeat it but with other samples ID (more based on IC50 than z score; only based on z score)- try repeat the same but with protein expression instead
- find github single cell sequencing


Results and follow up
only two sensitive for proteins -> look at it again, find another way to create sensitive vs resistant patients (only based on IC50) and add more samples maybe 7-8 in each category 









April 30 
finished: literature review, chose adenocarcinoma as lung subtype due to many existing targeted therapies and resistance to treatment observed due to activation of some signaling pathway, identified driver mutations in lung adenocarcinoma from literature and ROMA, started creating generic boolean tailor to lung adenocarcinoma
tried: create plots of genes expression according to groups with ROMA
to do: finish generic lung boolean cfg (think about what signaling pathways to keep) and start bnd(think about what node to remove and how to change logical rules accordingly) and try computing attractors with Maboss web for some initial states. Do we obtain the same phenotype as for prostate paper? 
1) keep all inputs off
2) keep all nutritents ON
3) keep all stress/ acidic/ DNA damage ON 







to do !!
- check if there is the common protein mutated in lung in the hallmark file and in the original prostate boolean network 
In original prostate Boolean 
-> EGFR yes
-> ALK no
-> ROS1 no


lung- EGFR and KRAS mutations at the origin
-> EGFR yes
-> KRAS not really we have RAS



challenge:
- select genes to add to the generic boolean and then combine them to the original 


Boolean networks of lung adenocarcinoma :
- key genes, signaling pathways, microenvironment cues
- driven by oncogenic mutations and dysregulated pathways

- mutated genes
    Driver genes and oncoproteins: KRAS; EGFR (frequently overexpressed), ALK (fusion oncogene - EML4-ALK), ROS1 - fusion oncogene; BRAF - can be muated; MET- amplification; RET - fusion partner gene;

    Tumor suppressor genes: TP53, STK11, KEAP1, RB1 

- Signaling pathways
    PI3K/AKT/mTOR - upregulated
    MAPK (RAF/MEK/ERK) - downstream of KRAS, EGFR
    JAK/STAT3 
    WNT/b-catenin


- microenvironment inputs 
    Hypoxia - tumor oxigen deprivation
    acidosis - tumor metabolism
    immune checkpoint - PD-L1/ CTLA-4
    TAMs - Tumor-associated macrophages (IL6, TNF-a)
    Tregs - immunosuppressive signaling (IL10, TGF-B)



Lung 
literature: KRAS mutation, EGFR mutation
ROMA: TFF1 (ER response early), CACNA2D2 (ER response late), CLDN18 (Apical junction), GPX2 (P53), FOSB (UV rep), SPP1 (angiogenesis), HBB (heme metabolism), 
SCGB1A1 (peroxisome)






escape mechanisms: MET amplification, EGFR amplification KRAS and BRAF mutation

Prostate
specific genes/ mutations: SPOP and AR
pathways identified using ROMA (for each pathway - genes contribute the most to overdispersion)
omnipath 
up-to-date literature
final network: androgen receptor, MAPK, Wnt, NFkB, PI3K/AKT, MAPK, mTOR, SHH, the cell cycle, the epithelial-mesenchymal transition (EMT), apoptosis and DNA damage pathways.
challenge: don't know the original generic boolean network... no available data

from chatgpt: AR, AR_ERG, ERG, NKX3_1, and SPOP most prostate cancerâ€“specific markers 




Mai 1 

Finished: learn how to use WebMaBoSS, slightly change the generic prostate model to lung and run simulation using WebMaBoSS,
          confirmed cell model passport patients data have common data with MaBoSS prostate
Tried: found out that only 8 resistant vs 128 sensitive against Avagacestat
To do: try to do a sensitivity analysis with WebMaBoSS (give many mutations and see which one lead to which phenotypes); try to understand why in the resistant patients there are not rna seq ..; and compute proba associated with state based on max expression gene in the rnaseq 


tailor generic boolean network to lung 
- RAS -> KRAS
- remove AR_ERG
- keep AR
- keep foxa1 (TF can be dysregulated in cancer, can explain drug resistance)
- want to add Sox9 (linked to EMT, cancer drug resistance) but not many data -> not added yet   
- keep p53 (frequently mutated)
- remove NKX3_1 (marker of prostate cancer)
- remove SPOP (not many research)
- remove fused_event


later: check ROMA genes 


- for the inputs keep them external


- can use neo4j to see if there is any interaction between my new protein and proteins of the generic prostate model such as:

(MATCH (p:Protein {name: "NEW_PROTEIN"})-[]-(s:Protein)
WHERE s.name IN ["P53", "BRCA1", "MYC"]
RETURN s.name)

WebMaBoSS
- can directly change the initial state, specify the output, add mutation (red -knock out; green - activation)
- look at the effect of the mutation by looking at state probability trajectory graph


assumptions
- lung cancer and prostate based on same signaling pathways altered but on top lung has KRAS and EGFR mutations





Mai 2
tried: for the u_gene and d_gene: computes a probability between 0 and 1, based on relative expression, run MaBoSS simulation with python and compute metrics of probability

protein, gene: continuous -> change u_gene/d_gene according to gene expression and protein abundance 

to do: try to find a way to extract the data associated with proliferation/ metastasis/ apoptosis from WebMaBoSS and see how they compare to drug sensitivity 
- have to add the low gene expressed 
- state all assumptions and try to validate with literature (can we use RNA seq expression and protein abundance as transition rates?), and can we say that the u_gene is = proba based on its expression?

- create pipeline to compare the distribution of each phenotype between sensitives and resistants





Mai 3
finished: merge the proba phenotypes dataframe with drug sensitivity (IC50) and compute correlation (result: not high negative correlation)
to do: repeat the process with protein abundance instead and then combine both and see if get better result

should maybe increase the time of the simulation ? since apoptosis does not behave in the expected way 
change the way i identify sensitive vs resistant (maybe not restrictif enough)
pick another cancer and drug 


assumption: protein overwrite gene (high protein level more significant than low same gene level)
            multiomics data of patient same time as the drug measurement




Mai 4
finished: run generic lung model when inputs off and nutrients on and EGFR/KRAS mutated-> get expected results, found out it is better to run MaBoSS pipeline.
Started: poster
to do: change figures of the poster, try to simulate KRAS/EGFR mutated in sensitive and resistant; compare results phenotype distribution bw if use proteins or genes or both
check that we can reproduce prostate results


try simulate KRAS and EGFR mutated in all patients, then simulate EGFR inhibitor (drug) and check if different response to treatment 

try to simulate effect of EGFR inhibitor when KRAS is present


Mai 5
finished: some vizualisations for the poster, identify different phenotype distribution according to each patient when KRAS and EGFR are mutated

Mai 6
finished: create bnd file, in the progress of changing bnd files manually with KRAS/ EGFR mutations if missense (leads to overactivation)
tried: to change KRAS and EGFR directly in a pipeline, try to simulate cancer with specific mutations and simulate behavior of drug and see if some patients response in a different way
Results: there are some patients who do not have the same phenotype distribution but we cannot see that when EGFR is mutated this seem to significantly change the phenotype distribution (by blocking metastasis for example)





to do:
- try to see if the 2% is significant (stats test between the two means)
- try to stratify all the patients (resist and patients) according to their phenotype distribution
-try to see if we can simulate less strongly 
- check if the algo has many different inputs at the beginning  of the simulation ??????
- for poster: table (row: sensitive, resistant and column: proliferation, metastasis)
- check if patients have or not mutations EGFR, FGF (part of personalization)
- try to investigate why some patients (such as SIDM01149) has more metastasis than other
- try to see if there is a correlation between z score and %metastasis/ apoptosis
- read paper again to check the protein abundance/ gene expression and see if we can change the transition rate like this 
check again the protein/ gene in the common signaling pathways related to cancer




1) create table changing inputs (genes now and then proteins)

does not make change to compare between groups if random inputs unless there are many inputs 
try to do it on the generic one (random inputs) and compare with the random inputs and KRAS mutated of sensitive/resistant

- try to see all permutations but can start with only one ON and all the other off -> heatmap ? add variance (see which input show the biggest variance)
- understand MaBoSS simulation


-> manually changed mutations_kras_ids: ['SIDM00344', 'SIDM00771', 'SIDM00143', 'SIDM00925', 'SIDM00921', 'SIDM00138'] 
-> mutations_egfr_ids: ['SIDM00755']


to do
- check again the MaBoSS phenotype file, how can i create a dataframe with sensitive and resistant on rows and different inputs fixed on columns with the mean for each phenotype in the table??



Mai 7 
finished: compute phenotypes distribution for diff inputs for sensitive and resistant.
tried:
to do: create functions for each of the file + documentation, vizualise the outputs in a table

results info
very different results in terms of phenotype distribution accross the resistant patients, I am not sure the mean will be representative
not many lung adenocarcinoma, so keep all lung cancer, then resistance computed with z score (-2; 2), have 4 resistant and 9 sensitive




Mai 8 

Finished: create pipeline and modularize the files with specific functions, added more samples in the two categories - resistant and sensitive
tried: to compute p value for each condition-phenotype pairs with Shapiro-Wilk Test but the samples is too small (need at least 5 values) -> restratify the patients according to their drug sensitivity (largest 10 z score and lowest 10 z score)

Results

- Identify 3 resistants/10 with KRAS mutations 
- Identify 7 sensitives/10 with KRAS mutations
- KRAS mutations: ['SIDM00344', 'SIDM00771', 'SIDM00143', 'SIDM00925', 'SIDM00547', 'SIDM00921', 'SIDM00702', 'SIDM01119', 'SIDM00138', 'SIDM00512']

Data values are not normalized (shapiro test) -> Mann-Whitney U Test (test two independents samples: sensitive vs resistant)



Test with alternative = two-sided 
                        Mannwhitneyu_P_value_Resistant
Phenotype  Condition                                   
Apoptosis  Nutrients_ON                        0.037667
           Acidosis_ON                         0.008350
           TNFalpha_ON                         0.004484
Metastasis EGF_ON                              0.008728
           Androgen_ON                         0.008728



Test with alternative = Greater
                            Mannwhitneyu_P_value_Resistant
Phenotype     Condition                                   
Apoptosis     Nutrients_ON                        0.018834 *
              Hypoxia_ON                          0.034080 *
              Acidosis_ON                         0.004175 **
              TNFalpha_ON                         0.002242 **
Proliferation EGF_ON                              0.049035 *
              Androgen_ON                         0.049035 *
Metastasis    EGF_ON                              0.004364 **
              FGF_ON                              0.046926 *
              Acidosis_ON                         0.046217 *
              Androgen_ON                         0.004364 **
    
p-value < 0.05 â†’ One star *
p-value < 0.01 â†’ Two stars **

p-value < 0.001 â†’ Three stars ***


Apparently EGF will drive more proliferation in resistant than sensitive -> try to block EGFR ? (confirm why there are available drugs that block EGFR)


To do: Create another table for better vizualisation (look at the python file)
       stratify patients according to their distribution of phenotype and identify the drivers to these phenotype
       find again the paper about the interested drug and its maybe potential to become a anti-lung cancer -> so i can talk about it in my poster and justify my choice and explain that i can use this pipeline for more cancers/ drugs


Mai 9 
to do: take some time to visualise the results (create a heatmap of different inputs and the output, create a nicer table), learn what does MaBoSS do (same as random walk but with proba?)
if time: stratify patients according to their phenotypes and identify the drivers
heatmap one for resistant and one for sensitive


to do: confirm the table has the right values!! and create boxplot of the table



Mai 10- 11
to do: finish boxplot of phenotype distribution + mutations/ gene signature to clusters, finish introduction part of the paper 



Mai 12
finished: boxplot,
tried: 
To do: simulate EGFR knock out, try varing K and see if nicer clusters



Mai 13
Finished: change poster forma
to do: identify differently gene expressed (do it for metastasis and proliferation), simulate EGFR knock out


Mai 14-15
finished: poster, identified differently gene expressed

Mai 16
started to write a plan with what i want to say in the thesis



Mai 17
finished: generalize the code for combination of cancers and for any folder 

to do: read prostate paper again and check if they look at drivers of resistance (genes enrichment in one specific phenotype), look at other papers about this, how can i have more patients data with cell model (enabling me to have drug sensitiviy data)
significant results with only 15 patients in each group? should i take data for many cancer and see why resistant to a specific drug ?
if look at combination of cancers -> can make sense as we are interested in the crosstalk of signaling pathways and in cancer 
to do: try repeating this but for many diff cancers with the same drug and find an example in papers where we know that a particular 
protein is responsible for resistance 


Mai 19-20 


to do: 
- check that differences of phenotype is not linked to cancer type
- look at the validation of prostate personalized boolean paper
- look at common signaling pathways that lead to resistance and check if there are genes related to resistance

create github clean 
- clean the pipeline 
- comment the functions 






Results (when we combine many cancers together and look for one drug)
- some gene makes sense (bcl2, myc) to be higher expressed in one group but there are also other genes (pten) that is not supposed to be highly expressed 
and expect EGFR to be higher expressed in the resistant group as higher proliferation when EGFR si activated upon EGF...
no apoptosis condition significant 

discuss with graeme: can i just say that one or two genes are differently expressed in one group even if other are not as expected?
validate my result (BCL2 higher expressed - anti apoptotic gene) with papers 





-> manage to create github with the pipeline and virtual environment (res_attr) and required files but some issues when try to recreate virtual MaBoSS so did not manage to run the pipeline



TO DO: check the resistant id are above 2 and sensitive id are below -2 !!!!!!!!!!!!!!!!!!!
check that the fct that removes

results: if i remove haemopotoic -> not many data for sensitiviness....-> to check

Mai 20
to do: try to remove haematopoetic and see if this changes the distribution of phenotype and try to run the file to see 
if maboss is well installed



to do: 
- try to see if we can find another drug with more patients sensitive and resistant regardless haematopoietic patients
- try to have many inputs ON and rerun pipeline to see if this will impacts the proliferation phenotype between resistant group and sensitive group.





Mai 21:

finished: removed haematopoietic tissue as does not behave like the other tissues-> found out that the origin drug selected does not show any sensitive patients (below 1.5>), tried with more inputs ON (EGF, TGF, Nutrients, Androgen)
results: when remove haematopoietic tissue, does not have the expected results (tried with 20 and 50 per group) and with Pictilisib drug 
when EGF, TGF, Nutrients, Androgen ON -> more metastasis (proliferation does not change)


to do: summarize quickly the paper prostate personalized and find other papers about drug resistance, -> in the paper: create personalized boolean with TCGA dataset and check correlation with gleacson score and then create somewhere like 8 cell line models with other dataset; can repeat the same ?

check if keep lung -> keep KRAS but if pan cancer -> keep RAS instead & add more mutations


idea: try another drug, gives more info to personalized networks 
-> if personalization seems to work better try keeping the same on TCGA dataset (check if tumor stage)
-> maybe now that we explore pan cancer, does not make sense to have only EGFR and KRAS mutation ? should have more mutations 



1. try with two other drugs, if no interesting results-> include more multiomics info (mutations common in cancer, proteomics data, CNV)
and also change initial state of EGF/FGF based on gene expression 
(try to keep PAN CANCER)
2. Once personalization done, test it on TCGA data (combined with stage info) to validate the personalization 

( i have also changed the montagud nodes -> so i have KRAS now and used to have RAS, and remove genes specific to prostate so maybe diff due to this as well and not only blood tissue??)

-> change so models are saved in a directory with the drug name 



Mai 22
finished:tried with two other drugs but no great results, no change if repeat with another drug or if keep original montagud nodes. Maybe just lung cancer works slightly better but not amazing
to do: try with only lung tissue



4. add mutations info, CNV, proteins abundance



!!!!!
select mutations -> OncogeneHighImpact (as high in VepImpact and are oncogenes)-> assumption: overactivation
                 -> TumorSuppressorHighImpact (as high in VepImpact and are tumor suppressor)-> assumption: loss of function
                 -> if in both -> OncogeneHighImpact


select cnv      -> gain and amplification -> 1 group
                -> loss and Deletion -> 1 group (assumption -> loss also deletion ?)


Amplification 
Node EP300 {
    logic = 1;
    rate_up = 1;
    rate_down = 0;
}

Gain 
Node EP300 {
    logic = 1;
    rate_up = 0.5;
    rate_down = 0.1;
}


Loss (not complete):
Node EP300 {
    logic = EP300;
    rate_up = 0.2;
    rate_down = 1;
}

Deletion 
Node EP300 {
    logic = 0;
    rate_up = 0;
    rate_down = 1;
}






Mai 23
to do: modify tailor gene expression to also change initial states (EGF, FGF at least)
        normalize gene expression first? or used data already normalized??
        try to run pipeline on tcga dataset





Mai 26
Validation - TCGA gene data: FPKM_UQ -> already normalized, better for cross study (samples) comparison 
           - TCGA CNV data: 
           - TCGA mutations data: goal to identify LoF and gain of function Mutations 
                    -> Sensitivity to real somatic mutations (true positives)
                    -> Specificity (avoiding false positives)
                    -> Functional impact annotations
                -> MuTect2 recommended (Captures both LoF and GoF mutations)



finished: change personalize boolean function to include both upper and lower cases, compute phenotype mean for each patient group 



if filtered and keep only the common id -> only primary tumor as samples 
-> group by disease stage

TRY TO ALSO MODIFY INITIAL STATE (EGF, FGF) based on gene expression



Results: 
- when we include CNV as bnd modifcation (change rules of genes) and genes expression we obtain that proliferation phenotype increases with the cancer stage
- gene expression FPKM-UQ: normalized, better than FPKM for comparison between samples (more robust to technical variation and noise)
- normalized by gene length & upper quartile of counts (ignores lowest 75% of genes)



Proliferation level:
Stage 1: 0.7
Stage 2: 0.7
Stage 3: 0.8
Stage 4: 0.9
However metastasis does not behave the expected way (we can't see a very strong increase)
-> try to include somatic mutation data

mutations overwrite CNV ???



TO DO !!!
pre-process of cfg files -> remove all _ in middle of the gene name
for the main pipeline repeat but for all cancers 


Mai 27 
finished: add function to change the new phenotypes nodes of the bnd/ cfg files, adjust the validation pipeline to include for DNA repair, migration, invasion, (on top of proliferation and metastasis)
tried: to change the cfg and bnd files with Ignore upper case but did not manage, to compute the phenotype distribution for the validation (with the new phenotypes) but does not work > get only 0 values
to increase the max time and nb of samples but still only 
-> try to see if this function works on the main pipeline??



to do:
try to rewrite the function compute phenotype (look at maboss library- reproduce the paper)
try to change all cfg and bnd files so they all have genes names in upper cases and remove all '_'
to do: rerun main pipeline for Pan cancer to see if we have increase of proliferation in resistant

check why DNA repair is not activated (this and the proliferation should be the important phenotype that changes according to the 
cancer stage)


in the main pipeline: invasion phenotype that is not in the validation pipeline, is the function wrong or its just that there is no phenotype??






Mai 28 
finished: rewrote the function compute phenotype

should we change the generic model to not only have Lung ??

Results 
- noticed that the phenotype converge to 0 -> compute the diff bw states and for all phenotypes get 0 -> reduce max time 



Mai 29 
finished: validation pipeline
tried: to group 1-2 stages together and 3-4 together but not significant results 


to do: try to understand why the results are not significant, not correct function or really not significant?
         if so try to increase sample size and try to change the group (based on different form of disease and not stage??)
-> try to group the early stages (1-2) and late stages (3-4) together


 try to change all cfg and bnd files so they all have genes names in upper cases and remove all '_'


 Observation/ potential explanation of not significant results:
 -> Tumor stage measures extent of spread (size, local invasion, metastasis), not necessarily cell proliferation rate.
 -> A tumor could be small and highly proliferative, or large and slowly growing.
 -> Stage definitions differ by cancer type (e.g. TNM system varies).
 -> Kruskal-Wallis needs reasonable group sizes to detect differences.
 -> Gleason is histological; stage is anatomical. They're not directly equivalent.




observation: 
- there is no diagnoses.tumor_grade data


primary_gleason_grade.diagnoses
secondary_gleason_grade.diagnoses
which one to chose ?
-> values: patterns 1,2,3,4,5

TO DO:
- Try to repeat this but with prostate data -> so we have the gleason score and we can validate our approach to personalize the networks directly 




Mai 30 
- rerun validation pipeline on prostate data 

illumina seq genes data (first dataset)

later: try with protein abundance instead of gene expression and repeat to see if get results closer to reality


Data: Cohort: TCGA Prostate Cancer (PRAD)
genes: illumina seq (normalized log)
phenotypes
CNV: GISTIC2 Thresholded (gene level, removed germline cnv (inherited and also present in normal tissues),discrete values -> -2, -1, 0, 1, 2)


pre-processing
1) gleason score (sum of primary and secondary grade)
    6 = least aggressive cancer typically reported
    7 = moderately aggressive
    8â€“10 = High-grade, aggressive cancer

    -> rewrite all the generic model with upper cases (manually)


changes generic prostate model 
-> b-catenin -> CTNNB1
-> caspase 3, 8, 9 -> CASP3, 8, 9

-> CHK1_2 -> two rows for CHK1 and CHK2 -> (CHK1 | CHK2)
-> cyclin B -> CCNB1
-> cyclin D -> CCND1
-> cycC -> CYCS
-> Dsh -> DVL1
-> e cadherin  -> CDH1


-> MEK1_2 -> MEK1 and MEK2
-> NF_kB  -> NFKB 
-> Snail -> SNAI1
(all remove all the _)
-> TNF -> TNFalpha
-> TSC1_2 -> TSC1 and TSC2
-> BCL_XL -> BCL2L1
-> MAP3K1_3 ->  MAP3K1 and MAP3K3


attention: HSPs -> HSPS

Node mTORC1 {
  logic = ((AKT | (AKT & Rheb)) & !AMPK & !TSC1 & !TSC2);
  rate_up = @logic ? $u_mTORC1 : 0;
  rate_down = @logic ? 0 : $d_mTORC1;
}



/// issues here no?? since RAF not sufficient to activate ERK??
Node ERK {
  logic = (RAF | (MEK1 | MEK2));
  rate_up = @logic ? $u_ERK : 0;
  rate_down = @logic ? 0 : $d_ERK;
} 





June 1 
finished: changed montagud nodes with gene names, validation with prostate data -> no mutations yet
to do: recreate generic pan cancer cfg and bnd from new montagud nodes (remove nodes specific to prostate cancer)
    run the pipeline on the generic model, then only on model with gene expression, only with CNV, and with both 



June 2: 
to do: repeat all the pipeline for PAN CANCER with new generic and cfg files but without mutation data for now (as did not include them in the validation pipeline)
modif of the lung model: 
- remove AR_ERG
- remove fused_event
- keep NKX31 (not only highly expressed in prostate cancer but also )
- keep SPOP 




Jun 3:
finished : computed stats p value
to do: run boxplot, rerun on the generic models to check personalization works well 
try proteins abundance instead of gene expression for the validation and see if can get better results
start pipeline for biohackaton


Jun 4: 
finished: recreated boxplot function, run simulation on generic PAN cancer model, finished pipeline on proteins data (recreate generic prostate model with proteins instead)

pre-process generic protein Prostate model:
CHK1_2 -> CHK1 and CHK2 
etc.. 



June 5
finished: updated the proteins data (changes b-catenin, e-cadherin,..), cleaned validation pipeline

to do: compare results between proteins and genes data 
do the downstream analysis - gene enrichment in a new pipeline
!! in the gene enrichment analysis -> make sure difference we see do not correlate with gender or/and cancer type!!!


to do: make the code as generalizable as possible (add functions),epeat but with both genes and proteins (if overlaps -> proteins instead)

CTNNB1 not in proteins
changes cyclin ? (CyclinE)
check also E-cadherin
check beta-Catenin
issues: BETA_CATENIN, beta-Catenin -> remove '_' in the montagud nodes list 




maybe later check that the gene that encodes b-catenin is indeed in the gene expression data


check if gene enrichment works well
then reclean the code with the folders


!!! check b catenin in CNV 
should i really remove the fused_event from the montagud nodes for the prostate validation??




!!! check NKX3_1 in the montagud nodes 

to do: try running gene pipeline prostate validation and see if works




Jun 6:
to do: debug pipeline pers with gene enrichment, start writing the abstract




Jun 16:


finished: computed variance of gene enrichment, checked gene enrichment not gender or tissue-related,compute power calculation for each condition-phenotype pairs for the resistant and sens patients
and start for gene enriched as well, wrote the function pers_interventions


catch up Graeme 
- had to create different boolean networks for proteins and genes -> difficult to combine both (or maybe creating a csv linking genes names and proteins)
- not better results with proteins data
- expected result: less proliferation for generic models than personalized 
- for the attractors computation algo -> fine tune to identify the best time for convergence (if wait too late, seems that all attractors converge to 0)
- genes enrichment analysis: compute mean and variance, how can i use the variance? -> what if abundance is tissue-dependent?
- validation according to the gleason score (prolif and DNA repair as expected, apoptosis higher in the high gleason score group)

-> only look at proliferation and DNA repair results ??

-> invasion: 0.7 -> 0.3 -> 0.37 

seems that migration is never ON????

questions:
- do we need to do a power analysis to compute the nb of patients needed to have statistically relevant results?
- why proliferation is different but not invasion or metastasis phenotype? (but in the validation, paper used DNA repair and proliferation) -> what biological phenotype is sufficient to keep??




when we create the groups to then do gene enrichment, what value should we use here (0.1 is enough)? 
 group_phenotype_resistant = data_phenotype_patients[
        (data_phenotype_patients["Drug status"] == "Resistant")
        & (data_phenotype_patients[f"{condition}_{phenotype}"] >= 0.1)
    ]



to do:
- create boolean network with both genes and proteins (changes proteins names to genes)
- gene enrichment in the validation pipeline?
TO DO: later- changes EGF and TGF initial states according to expression
AR_ERG in the person models and not only in the validation??



-> to do: create boolean network with both genes and proteins data 


intervention, should we only change the bnd files or also the cfg ?

Results: proliferation is not reduced when we block FOXA1, BCL2 and BIRC5 -> try to block more genes
-> can also try to induce the one higher expressed in the sensitive group 

-> if increase to 10 -> nice results but if increase only to 6 not nice results 
-> check if it is due to one specific gene or not



June 17 
to do: check if specific genes that reduce proliferation, find a way to create boolean for both proteins and genes (do we have 
a dataframe linking proteins and genes?) and think about rules bw genes and protein. (attenutates or increase genes impact if protein present?)
how to session -> create a better plan to present to graeme on wednesday and start abstract 


check if can block E2F1






catch up graeme:
finished: check assumptions with Mercedes, updated method part of the plan, 
- tried to block one gene (E2F1)-> proliferation is not more significant (simulate a KO) -> not always the case if block other genes (if block top 6 and E2F1 not included)
- E2F1 can function as both as oncogene and tumor suppressor gene


to do tonight - 19 june 
- find gene protein mapping -> start creating pipeline that combine both gene and protein (should i keep both with the same weight?)
- create dataframe with one column every genes proteins names and another column with the montagud nodes associated
-> in all dataset convert all the synonyms to the montagud nodes 
maybe montagud nodes represent genes and protein names will be also associated to its gene name 


# # in my genes data and copy nb variation, transform all the names to the montagud nodes names





June 20
to do: look again at the prostate paper; compare gene and proteins names (how to do with synonyms?, if proteins not same name as gene?, why invasion never activated?)



two issues:
1) how to combine both genes and proteins?
2) genes and proteins have synonyms ?


in proteins : no Caspase node changed but there is info for some patients, why?
-> okay all good, the protein has been correctly replaced



June 21
to do: keep writing background, find papers avout the topic, think about what to do with the last part of the code (heatmap,..) clean the code, remove the not necessary functions

-> clean code, comment (add function description), write Readme, 
et after check validation of graeme's project



also check how i can create nicer figures




June 25

finished: did some research on resistance mechanisms, cleaned my pers and generic pipeline by creating functions, change the downstream analysis file and run on each gene and identify automatically the one that induce a decrease of proliferation. 




and create a nice folders with all the models/ results -> is my architecture good ? should i have one folder with the model and results for each drug, or should i have a folder with all the models, and another one with all the results ? 


website 
- Refametinib can induce drug resistance through various mechanisms, including activation of bypass pathways and feedback loops 
mechanisms 
1) secretion of macrophage migration inhibitor factor (MIF) by KRAS-mutated CRC cells -> activation of STAT3 and MAPK pathways (ras, raf, mek) -> bypassing MEK inhibition
2) feedback activation of AKT signaling in HER2-pos breast cancer cells 
3) anti-egfr : PI3K signaling -> acquired resistance to refametinib in KRAS mutated CRC




genes that might induce resistance: 
genes belong to the MAPK signaling (KRAS, BRAF, NRAS, or others), STAT3, 
genes related to cell cycle (Cycline ? CDK ? ) and apoptosis (CASP ?)
(genes related to STAT3 pathway (hif1,))


-> RPPA analysis: resistant cells to refametinib have higher baseline P levels of EGFR Y1068 relative to the sensitive 
and this phosphorylation induce activation of EGFR -> increase downstream signalling of MEK/MAPK signaling 

other drug: Erlotinib -> targets EGFR



to do: 
- then check if mutations of these genes or check some known proteins that cause resistance (even if not diff expressed, such as PI3K)



ask thomas how he thinks i should create my folder -> give all paths at the beggining and create all directories? or along the code? 
personalize with mutations or just mutations enrichment?






to do:
check why new resistant folder created, check why not same results at all (very low prolif in res), downstream analysis with the bool if intervention true 


June 27
to do- understand why wrong results 


1) jupyter to compute the results then if not same results as before -> go back to pipeline 1






Jun 28 
finished: pipeline 1, pipeline 2, code of pipeline 3
to do: check code of pipeline 3 okay and think about should we just look at all proliferation phenotype or one specific?? 

Jun 29 
to do: try creating fct to simulate many inputs ON (like the one of the paper)
why boxplot shows two same input  ? why egf not sign anymore?
in my pipeline include test not related to gender or tissue; and include gene or protein option to create the boolean networks
why identified earlier E2F1 when block no prolif anymore?
check gene parameter in the compute_mannwhitneyu_test_means

create validation fct for gene and for protein as parameter
check the patients id, always the same???









week of 30 june 

finished: tried with other drug (no better results...), tried to reduce to 15 patients
- try cb of inputs (all gf ON) 
- try with other drug 
- try to be even more selective with the drug (more than 1.8)
- try to also simulate the drug effect by inhibiting its target
- include check not related to tissue or gender 
- maybe res and sens id are not the same?
- remove the 'pers_models' folder
- maybe identify a drug target per patient? 
- add some mutations to personalize and other data (proteins?)


-> maybe really patient dependent ? can we find target for each patient?


reduce nb of patients did not help and changing to another drug is worse





June 30:
finished: added the drug target knock out function, added the get cell lines function, changed the downstream analysis to include the case when there are more than one input 


to do
- simulate drug effect (inhibit MEK in the two groups) and check if diff of results
-  be more restrictive with the patients and the drug (above 2 and below -2)



- compare between before the drug and after the drug for the resistant and sensitive ? 
- check we only keep the patient id for which we have info about their gene expression, cnv, mutations,... ?



1. simulate MEK knock out in the two groups and check the results
2. add fct with cell lines related to patients ids 
2.2. maybe add the function to simulate drug effect when we create the networks ?
3. try with other drugs and compare results 

4. worse case - include mutations, replace gene by proteins data 




-> run with many inputs ON
-> output the cell lines distribution
-> run for other drugs and check which one behave like Refametinib (based on what part of signaling pathway?)

-> include option of having proteins models instead of genes 


but refametinib not very significant but more than the sensitive for sure (maybe > 1.5 but not > 2)



in the model of the paper- EGF always ON ??


make sure we only use p adjusted values


should i look at sample site or tissue? cause very different...



to do: debug and try to plot histogram if this new condition, the p value is correctly calculated?

to do: run with the other carcinogen condition -> boxplot, white U

check why EGF is always ON in the models ??








assumption with chk1 and chk2 ??

try with proteins instead, try gene as discrete variable and cnv as continuous variable -> what gives best results ? 
review the validation pipeline 


also specify type_models for the personalization and if gene -> personalize with genes, and if proteins -> personalize with proteins


check after for proteins how to deal with the '_' in the nodes names 

-> finish 


July 2
to do: finish genes/ proteins modulation (import genes pers if gene type), finish clean validation function and pipeline, check again why E2F1 reduced significantly the proliferation?

NKX3_1 how to handle it ??




check why always the same p adjusted values, also power calculation
why in the validation, some patients have exactly the same results outputs ??
maybe should i do only two groups ? low/ middle vs high ?

check the validation also works with proteins data -> add if type models is protein then do protein function




June 4
to do: try to simulate KO of the Pictilisib drug, and rerun for every drug 
check for the power calculation (as missing a braket)
check the apoptosis node and its targets

check stats tests (kruskal and mannwhiteU)
remove all the 'pers_models' and change all drug name by context_models
get cell lines maybe call it when create the models?
what does 1 mean in the attractors distribution? is 100% ?

what if all the other variables are:
$u_CASP3 = 1;
$d_CASP3 = 1;
-> does this really make sense or would it be better to have them random or fixed to another value ? cause apoptosis is really high 

to do 
- check if use proteins do we get better validation results ? 




1. understand gleason score 
2. Try with proteins instead of genes and repeat for refametinib




July 4
finished: added synonyms of proteins, genes, cnv; removed healthy samples, 




look at annotation data for interpretation -> why apoptosis higher ? can it be induced by cancer cells? do we only have a sample with cancer cells or mixed??

check each phenotype what does they mean 









to do: try to get the phenotype distribution for healthy samples (normal solid tissue samples) 
read paper and check again what data they used for the other nodes when no data available

check not related to tissue status but really to resistance (check distribution of tumour and metastasis in each group)

what to do with NKX3_1 ??





check that the phenotypes distribution not just related to metastasis samples ?-> compute nb of metastasis and tumor samples in each category


do a metastasis differential expression analyis in the differential expressed genes

mechanisms of resistance of akt inhibitor through egfr pathway ??


-> more strict for the gene diff analysis (maybe about 0.6 of expression?) -> used 0.6 instead of 0.1







July 5 
finished: added the distribution of samples tumor vs metastasis related to the attractors, added models of healthy samples 




TO DO: 
do the stats test (kruskal test?) bw the three resistant sensitive and healthy-> do a boxplot ??  
check proteins healthy models
check what is the migration phenotype 
also simulate target knock out of healthy patients??

check why with proteins the healthy patients get more invasion, should we also simulate ko of the drug target in healthy patients?
-> write and collect all the outputs/ results



July 6
finished: stats test on the three plots (healthy vs sensitive; healthy vs resistant), added the protein and genes together personalization, - check the third pipeline - simulate gene knockout, check if there are some genes that make sense to be highly expressed in the resistant group


what brings the blood tissue as other data??
look at models but maybe some share diff tissues??






July 7 

to do:
- try to increase the max time to see if we can get migration phenotype




try these following combinations to induce migration 
1. EGF + FGF + TGFB + TNF
2. EGF + HYPOXIA + TGFB
try to also include the one with significant bw res and healthy 
check all stats p value are adjusted

check that if remove node to remove -> does not change anything
same as tissue to remove....




TODO !!!
drug_interest = 'AZD7762'
drug_targets = ['CHK1', 'CHK2']
-> try to run the models and results by removing the not interested tissue and nodes


to do: pipeline 3 -> check why does not work the results, due to blood tissue???

check what happens if include the node to remove
check if get same results if keep blood tissue but with the gene intervention

why not same results if remove blood tissue???


check why including blood tissue to block egfr
or only include blood tissue?





try to rerun with blood tissue and if get the old results
and try to increase to 35 patients or more ?





maybe also depends on nb of patients to have significatif results??






-> make sure not biaised to tissue distribution



try running again with the drugs by excluding the blood tissue 

then try to block EGFR as started yesterday

and re run when included blood and check not related to tissues -> 








worse case -> just look at one tissue
try remove prostate nodes specific from the boolean networks




try only with blood tissue






observations: in the initial groups a lot of blood tissue in the sensitive group


in the big loop -> save the stats test and nb of patients required; and change the ratio of each tissue (correct but do it for both categories)
compute the nb of each tissue in each group 

simulate E2F1 KO for refametinib




146 min to run models. and results




July 8:
finished: computed tissue distribution in each patient group, removed the prostate specific nodes (fused_event, AR_ERG), apply synonyms to generic models (for baseline), 
gotbthe same piecharts as did before with the generic models
nutrients/EGF ON, Proliferation r
1. tried hemato only with 35 patients-> bad results 
2. tried with lung 35 patients Refametinib->
3. tried simulate EGFR knockout with CHK1 inhibitor 

pipeline 1: try to decrease nb of patients for hemato (15 patients) - no nice results
pipeline 2: compute results for Lung -good results
pipeline 3:  simulate EGFR knockout with CHK1 inhibitor - no nice results
-> also try hemato with refametinib









to do: rerun models and results for refametinib with genes proteins models after removing the two nodes and check does not change anything 

identify key driver genes and try to knock out these genes and rerun results

-> look at heamtopoetic only if observe diff bw resistant and sensitive then okay (if not try more restrictive -> be more resistant)




July 9 
to do:
check way compute diff of genes expression and check the ommon differently expressed genes bw the two drugs ? does it make sense ? share common pathways??



to do:
try with 50-60 patients in each group for refametinib genes and see if better power calculation and also if still invasion phenotypes 
keep writing (issues with not many resistant/ sensitive; balance bw nb of patients and tissue distribution)





July 10
finished: kept writing the discussion, mutations downstream analysis before KO or KI, simulate KI and KO of b caderin gene 





TO DO

!!! try to do the genes diff expression analysis bw healthy and res/ sens
!try to block EZH2 alone
!try simulate induction of CTNNB1 combined with knockout of FOXA1 and E2F1 (to try to reduce even more the invasion phenotype)


try EZH2 (represses E-cadherin), 
try PDK1 
try FOS 


 E2F1 ??-> can support EMT



 July 14 
 to do: try gene expression analysis on sensitive vs healthy, look for ctnnb1 literature, can we get boxplot of its expression? write down our results




 July 15
 to do: try to understand why CTNNB1 is equal expressed in healthy..
 should i try to compute also the gene expression mean for the healthy group?

 maybe for the thesis - recreate boxplot but only with the phenotype of interest ? and so we do not need to restrict to significant results only?

 kruskal test on the three groups of ctnnb1 ?



 ctnnb1 expression in healthy not very different from the expression in the resistant and sensitive groups
 -> dual role so maybe complicated to just look at the expression level ?



 results: significant p value but diff shapes -> there's a significant difference in the mean ranks or the overall distributions of the groups. 



 try to run again the KO of CTNNB1 but while only keeping invasion and proliferation as phenotypes
 -> try in the boxplot to only look at the significant values 
 -> check the distribution of data and also 
 -> try to block more genes ? 






 July 16
 to do: how much of invasion the patients have ? significant diff from before knocking out CTNNB1??

 sensitive- more sensitive when KO CTNNB1







Found that MEK inhibitor limited efficacy in KRAS mutant





July 20 
- try to find if MEK and CTNNB1 have been identified as synthetic lethal screen 
-> not currently in the literature (SynLethDB database)



July 21 
- in the paper: more clear about the novelty - use attractors to stratify patients and then propose therapies targets 
                be more clear about why looking at EGF-invasion condition 
                share stats test of sign. lower invasion under EGF in the sensitive group when EGF is targeted
                in the discussion - mention the image that connects b catenin and MEK 
                material and methods - makes the pipeline better 
                better plot to represent the diff of invasion before CTNNB1 KO and after 


with graeme 
- synthetic lethal screen - obeserve anything between CTNNB1 and MAP2K genes ? 
- way of validating if this has not been observed ? - mail with mercedes 
- overleaf - how to display an image on two columns ? 




network X check to create networks (discussion part)-> color nodes b catenin and MEK 


- specify each phenotype, why we chose them and what does they represent - hallmarks of cancer ? 


to do: https://www.nature.com/articles/ncomms11581#:~:text=Cyclin%20D1%20(Ccnd1)%20is%20a,in%20cell%20motility7%2C8. 
read this article - double function of Cyclin D1 (invasion/ metastasis)-> do we also see this in my patients?





July 22
- could cancer cells induce apopotosis in healthy cells??
- Why high Cyclin D1 gene in the sensitive group...
- look if we have CDH1 in the rna seq data ? -> E-Cadherin 




to do: try KO of cyclin D1 gene, find two known genes related to invasion and when KO reduces invasion; try a third one not known in the literature 


TO DO: check proliferation increase after ctnnb1 is not significative


look at the result of cyclin D1 KO -> proliferation is reduced when KO ? -> check stats test 




TODO - try both cyclin D1 and ctnnb1 KO 




July 29 

to do: comprendre markov chain + stochastic process et ajouter method dans paper, debug code

s'assurer que les nodes du model sont ceux du paper montagud 
peut ajouter mapping synonyme 



comprendre comment on a modifiÃ© le generic model pour split les nodes 









June 30
finished: recreated the models by keeping the same initial names but changes in the files the names that they can be (with all the synonyms)
remove the tables for proteins and genes, 
tried: change the calculation of the transition rates



Results
not as good as results as before when keep all genes not only the most different-> maybe try to only keep the genes expression with high Z and low Z score

also change the validation functions (montagud nodes,..)




pour validation - regarder si meilleurs resultats si on ajouter fused event et ar_erg 

essayer aussi avec leur data de transition rates, est-ce que c'est mieux? 
change diff combination of data - cnv for continous ? rna seq discrete? - and compare with the validation


read the paper about stratification

que faire avec MYC_MAX ???


ERG try to also change it to OFF all the time ???
try different way of mutations (CNV) - with logic name as well?
increase the time of simulation
try with many inputs simulataneously

try modify initial state according to gene expression

try remove MYC_MAX -> does Myc takes a value ??
explain the new steps (remove table preprocessing, use new way of computing the transition rate, not change the node themself but map their synonyms to the names of the networks)


Results
- nice results with Pictilisib and PI3K
- not great results with refametinib -> but also high variability -> so require many patients 


to do: check what's wrong with the validation- maybe add the prostate specific gene 
        try to remove MYC_MAX and check that MYC takes some values as well as EMT and all nodes not at least once changed
        try to identify targets to block to reverse the effect

        try to understand why it works when targeting PI3K or CHK1_2 but not MEK1
        check the way calculate power (nb patients)





July 31 
to do: read the two papers,  try to understand why does not work with Refametinib but does with the other drugs (with the paper about resistance)
play avec les initial states - est-ce que ca change 
ecrire et modifier les parties du paper 


tried: to keep AR_ERG and fused_event in the validation but not better results







check that in the montagud nodes we have these nodes 
check what happens in case of doublon -> wants the transition rates to change to both genes 



should i also try to block EGF and FGF when simulate only the activation of one specific genes ?


worst case - can try with other data for the validation 

TODO:
- read papers 
- maybe try with other data the validation (for the other paper)
- change also the way of calculating transition rates for proteins personalization





TODO 
1. do survival analysis between phenotype and death (for the validation)
2. do genes signature correlation to phenotype 
3. if not nice results - try with breast cancer data






survival analysis on TCGA dataset (cellmodel passport data do not have survival data)
- event: status 0 or 1 if dead or not
- time: overal survival 
log-rank test : stats test to compare survival distribution of two or more groups



# Survival analysis - implementation

in paper - METABRIC dataset on Fumia model (somatic mutations, copy number alterations,
and gene expression)

run MaBoSS on many patients then group them based on their proliferation level (high vs low) -> extract their models id and then take the model id for which have info about event and time then run the logrank_test and check that p values is significatif to see a real correlation between prolif/ invasion/ apoptosis on survival outcome 


from lifelines.statistics import logrank_test
g_1 = [5, 6, 7, 8, 10]
g_2 = [4, 6, 8, 9, 12]
e_1 = [1, 1, 1, 1, 1]  # 1 = event occurred, 0 = censored
e_2 = [1, 1, 1, 1, 1]

result = logrank_test(g_1, g_2, 
                      e_A= e_1, 
                      e_B= e_2)
print("Test Statistic:", result.test_statistic)
print("P-value:", result.p_value)


try with breast cancer data : https://www.cbioportal.org/study/summary?id=brca_metabric (with overal survival and event dataset)

-> try this on random patients (check if more invasion) for prostate and then breast cancer (paper)
-> objective: prove that invasion, proliferation correlate with bad survival outcome (and so resistance)




# try to see if correlation between phenotype node and genes signature 

in the paper
MSigDB
GSVA R package, survival R package
Correlations are assessed based on Spearman rank method and 95% confidence intervals are obtained by bootstrap (n= 1000)
https://www.youtube.com/watch?v=egO7Lt92gDY

 For the METABRIC
cohort, the patientâ€™s Nottingham prognostic index (NPI) and
survival data 



Hallmark G2M Checkpoint
https://www.gsea-msigdb.org/gsea/msigdb/human/geneset/HALLMARK_G2M_CHECKPOINT.html

and apoptosis
https://www.gsea-msigdb.org/gsea/msigdb/human/geneset/HALLMARK_APOPTOSIS.html




In my research
GSEA dataset - hallmark Eithelial Mesenchymal Transition (Invasion)
https://www.gsea-msigdb.org/gsea/msigdb/human/geneset/HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION.html


->> use this approach to identify what is the best personalization method (for which the gene signature correlates the best with the phenotype node activated)





# try other combination of personalization (if wish ow can support my way with montagud paper)
# Try diff normalization method (based on the distribution of each gene)
# Try more resistrictive for CNV (only -2 and + 2)




August 1:
to do: write new validation method - compute correlation between apoptosis node On proba and apoptosis hallmark (same with EMT, and proliferation) for my current data 
repeat but with their breast tissue cancer data from cBioportal 

Do a survival analysis between low and high proliferation phenotype -> shows that proliferation is linked to worse survival outcome 




si la diff expression entre les genes est importantes -> normalizer tous les genes ensemble 
si seulement la diff expression du gene a travers plein de sample est important -> par gene okay

pour normlaization - check comment mes genes ont Ã©tÃ© normalizÃ© (pas ouf de normalizer par dessus) 
try other normalization (against all the genes)




TODO this afternoon
- visualization correlation 
- do survival analysis to compare between low and high proliferation group 
- vizualisation survival
- check normalization against healthy samples


try all this on their breast cancer data (with the mutations) check if better results

-> then modify normalization technique, modify formula gene transition, try CNV as continuous data, add mutations data







check what does normalization mean in the paper - same as data processing? 


finished: correct cnv tailor fct -> check if impact the results




August 2
to do: 
- check gene signature again in breast validation pipeline
-  check formula of normalization again (do we really need to do normalization ? other method of normalization? does it change the results a lot ?) 
- try with different normalization/ remove it 
- check the paper again (normalizazion technique, what best personalization method used?)
- try to include mutations data - does it change something ? 
- try with our way with CNV 




try to personalize with proteins first and if no info use genes instead 
try to also include mutations 
why can not have access to gene signature?
rerun again with this new normalization technique but with the other rna seq data (z score data)

when did the gene signature - need to exclude the genes used for personalize the model (it is said in the paper)? Why if so ?
can also extract Nottingham prognostic index from the metabric data



TODO

essayer de pouvoir utiliser the rna seq data dans la fonction correlateavec gene signature
proba against NPI




August 3
finished: replaced CNV by mutations data and run again the pipeline, correlation between proliferation proba of the model with NPI 
to do: 
        start thinking about what to change in the paper 
        change comment on a modifÃ© les genes normalization -> pour chaque gene calculer sa distribution et puis faire normalization en fonction 



        ajouter correlation Ã  pipeline 2
        ajouter que pour chaque gene calculer la distribution puis choisir la technique de normalization (si trop compliquÃ©- calculer distribtuion de chaque gene pour cell model passport rna seq gene et verifier que tous unimodal )

        peut-Ãªtre montrer que high invasion and tumor grade check correlation between





j'ai run the pipeline 1 avec Azd.. CHK1_2 avec CNV 

try to be more strict with cnv (just the +2 and -2)?



August 4 
Catch up - Graeme 


- not all the genes were taken into consideration 
- changes my way of creating the boolean networks to avoid removing nodes automatically 
- then changes the validation results
- found a paper about how to use boolean network stochastic simulation to stratify the patients - different ways to validate the best approach of personalization (correlation to NPI (represent severity of disease), correlate to pathway signature) and they compute survival analysis between low and high proliferation group 
- change way to calculate the up and down regulation of each gene based on their distribution (unimodal, bimodal, zero-inflated) and then apply the formula of the paper 
- add the mutations data





try to include both mutations and cnv and genes (Pictilisib and PI3K)


check distribution des genes cell model passport



!!!! bimodal genes distributions!!!!!:
['ERG', 'CCNB3', 'RAG1', 'NF1', 'ATM', 'GLI1']

essayer d'enlever le norme et voir si meilleur resultat 




TODO 
- redownload processed rna seq data and try to remove the normalization step
try with the other rna seq data (tpm..) and repeat with and without normalization







 August 5

 todo: check the distribution of one gene in each dataset, decide on the rna seq dataset i will be using 
 update parts of the text i did and collect all the formula and start the method figure
 identify diff expressed gene and try KO



essayer differentes methodes de normalization (quoi la reference pour identifier meilleure technique pour cell model passport data?)
1) normaliser un par un
2) normaliser en prenant compte des autres genes (comme dans un sample si plus d'un inhibiteur que activateur ca peut changer le outcome)
3) pas normaliser 


check amplif factor - comment le choisir
identify the best normalization technique based on the signature correlation

repeter avec 35 patients




Finished: all the diff normalization, combine the two pipelines (should i create a function?)
todo- check why NaN values in the networks


August 6
finished: created the main for the validation (with all the normalization technique), added the logg error, 


- add distribution normalization for proteins as well as all the other normalization 
- try to see if can use main function with intervention gene -> if so-> delete pipeline 3 



Possible hallmarks we can use
First 10 gene sets:
  - TNF-alpha Signaling via NF-kB
  - Hypoxia
  - Cholesterol Homeostasis
  - Mitotic Spindle
  - Wnt-beta Catenin Signaling
  - TGF-beta Signaling
  - IL-6/JAK/STAT3 Signaling
  - DNA Repair
  - G2-M Checkpoint
  - Apoptosis
  - Notch Signaling
  - Adipogenesis
  - Estrogen Response Early
  - Estrogen Response Late
  - Androgen Response
  - Myogenesis
  - Protein Secretion
  - Interferon Alpha Response
  - Interferon Gamma Response
  - Apical Junction
  - Apical Surface
  - Hedgehog Signaling
  - Complement
  - Unfolded Protein Response
  - PI3K/AKT/mTOR  Signaling
  - mTORC1 Signaling
  - E2F Targets
  - Myc Targets V1
  - Myc Targets V2
  - Epithelial Mesenchymal Transition
  - Inflammatory Response
  - Xenobiotic Metabolism
  - Fatty Acid Metabolism
  - Oxidative Phosphorylation
  - Glycolysis
  - Reactive Oxygen Species Pathway
  - p53 Pathway
  - UV Response Up
  - UV Response Dn
  - Angiogenesis
  - heme Metabolism
  - Coagulation
  - IL-2/STAT5 Signaling
  - Bile Acid Metabolism
  - Pperoxisome
  - Allograft Rejection
  - Spermatogenesis
  - KRAS Signaling Up
  - KRAS Signaling Dn
  - Pancreas Beta Cells




  healthy patients - low proliferaiton but also less patients - can we really assess their phenotypes are lower??

  make sure i really understand the expression values for the phenotype 




  how can i assess the genes to intervene ??





  TODO: for compute gene differential expression analysis -> compute the p adjusted value, attention!
  find a way to identify directly the genes to target (significantly more expressed in resistant)- maybe compute diff of expression between resistant and sensitive ? 

  TODO- run breast pipeline for min-max
  keep writing/ updating -> and continue methods diagram : explain clearly that used patients data (metabric) and find best pers method based on gene signature score and then use this pers method identified for cell models to explore drug resistance 
  create/ add tables of person combination with their correlation value (MPI, proliferation, apoptosis)
  -> both for the normalization technique and for the person combination of data 



TODO 
  update genes differential expression how compute p value-> need p adjusted values


  try to cluster the patients based on both their apoptosis and invasion phenotypes
  -> or keep patients with both high invasion and low apoptosis and repeat differential gene expression 

  check nb de patients and healthy group - sur qu on peut comparer


  further work : try to not simulate the drug effect 


  TODO - repeat with proteins instead of genes (change tailor fct with diff methods of normalization), and run again pipeline; and try to combine cnv mutations and genes/ proteins and then with all together 
  also recreate methods diagram and updates the discussion, and gives more details about how maboss work


   TRY THIS: KI of CTNNB1 - can we see dual role of CTNNB1??





   Aug 12
   - try cb protein and genes to personalize the networks 
   - update discussion part 



   specify that in the breast validation datasets -> no proteins 
   so identified mutations-genes as the best personalization method -> get results with this personalization method 
   and then try run the main analysis on proteins combined with genes (gene if protein not present)
   and check the results 



   add table with diffential genes 
   add more info in discussion - why use prostate model for pan cancer
   try to remove the prostate specific genes or do not mention it and say that the sginaling pathways are conserved accross



   TODO:
   - check what are the prostate specific genes- try to remove them? or justify why keep them
   - try KI of beta catenin
   - add genes diff expression table 
   - should we add proliferation phenotype ? and heatmap only with proteins ?

   find another target to block?? 
   beta catenin only gene induce invasion?







add p value for the heatmap genes-proteins model KO beta catenin legend





19 august 

to do:
- check why pipeline does not run with intervation = beta catenin-> meme resultats avant et apres KO ce qui n'est pas possible
- create run validation pipeline with variables in the config.env
- apres push config.env
- try more or less patients for the validation to have survival analysis that makes sense

check nb of patients for the breast analysis -> was about 1800... so first try with 200
check the packages used to create the heatmap and boxplot 


